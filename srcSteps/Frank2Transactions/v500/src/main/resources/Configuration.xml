<Configuration
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:noNamespaceSchemaLocation="../FrankConfig.xsd"
    >
    <!-- Accessing Db and queue -->
    <Adapter name="writeDb">
        <!-- This is the default: transactionAttribute="Supports" -->
        <Receiver>
            <JavaListener name="writeDb" serviceName="writeDb" />
        </Receiver>
        <Pipeline>
            <SenderPipe name="writeDb">
                <FixedQuerySender query="INSERT INTO message(message) VALUES(?)">
                    <Param name="message" type="string" defaultValueMethods="input" />
                </FixedQuerySender>
            </SenderPipe>
        </Pipeline>
    </Adapter>
    <Adapter name="causeDbError">
        <Receiver>
            <JavaListener name="causeDbError" serviceName="causeDbError" />
        </Receiver>
        <Pipeline>
            <SenderPipe name="causeDbError">
                <FixedQuerySender query="INSERT INTO message(message) VALUES(NULL)" />
            </SenderPipe>
        </Pipeline>
    </Adapter>
    <Adapter name="enqueue">
        <Receiver>
            <JavaListener name="enqueueListener" />
        </Receiver>
        <Pipeline>
            <SenderPipe name="enqueue">
                <JmsSender name="enqueue" destinationName="myQueue" messageClass="TEXT" queueConnectionFactoryName="jms/qcf-artemis"></JmsSender>
            </SenderPipe>
        </Pipeline>
    </Adapter>
    <Adapter name="dequeue">
        <Receiver>
            <JmsListener name="dequeue" destinationName="myQueue" messageClass="TEXT" queueConnectionFactoryName="jms/qcf-artemis" />
        </Receiver>
        <Pipeline>
            <EchoPipe name="echoDequeued" />
        </Pipeline>
    </Adapter>
    <Adapter name="enqueueForTransaction">
        <Receiver>
            <JavaListener name="enqueueListener" />
        </Receiver>
        <Pipeline>
            <SenderPipe name="enqueue">
                <JmsSender name="enqueue" destinationName="with-transaction" messageClass="TEXT" queueConnectionFactoryName="jms/qcf-artemis"></JmsSender>
            </SenderPipe>
        </Pipeline>
    </Adapter>
    <Adapter name="processInTransaction">
        <Receiver transactionAttribute="RequiresNew">
            <JmsListener name="dequeue" destinationName="with-transaction" messageClass="TEXT" queueConnectionFactoryName="jms/qcf-artemis" />
            <JdbcErrorStorage slotId="transactions" />
        </Receiver>
        <Pipeline>
            <SenderPipe name="callWriteInDb">
                <IbisLocalSender name="putInDb" javaListener="writeDb" />
                <Forward name="success" path="READY" />
            </SenderPipe>
        </Pipeline>
    </Adapter>
</Configuration>