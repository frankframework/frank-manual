<Configuration
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:noNamespaceSchemaLocation="../FrankConfig.xsd"
    >
    <Adapter name="TestValidation">
        <Receiver>
            <JavaListener name="IngestDocument" />
        </Receiver>
        <Pipeline>
            <Exits>
                <Exit name="READY" state="SUCCESS" code="200" />
                <Exit name="ERROR" state="ERROR" code="400" />
            </Exits>
            <XmlValidatorPipe name="validate" schema="input.xsd" root="document">
                <Forward name="success" path="getMessage" />
                <Forward name="failure" path="answerError" />
            </XmlValidatorPipe>
            <XsltPipe name="getMessage" xpathExpression="/document/header">
                <Forward name="success" path="decodeMessage" />
                <Forward name="exception" path="answerError" />
            </XsltPipe>
            <Base64Pipe name="decodeMessage" direction="DECODE">
                <Forward name="success" path="checkMessage" />
                <Forward name="exception" path="answerError" />
            </Base64Pipe>
            <CompareStringPipe name="checkMessage">
                <Param name="operand2">The document contents</Param>
                <Forward name="equals" path="answerOk" />
                <Forward name="lessthan" path="answerError" />
                <Forward name="greaterthan" path="answerError" />
                <Forward name="exception" path="answerError" />
            </CompareStringPipe>
            <FixedResultPipe name="answerOk" returnString="ok">
                <Forward name="success" path="READY" />
            </FixedResultPipe>
            <FixedResultPipe name="answerError" returnString="error">
                <Forward name="success" path="ERROR" />
            </FixedResultPipe>
        </Pipeline>
    </Adapter>
    <Adapter name="IngestDocument">
        <Receiver>
            <ApiListener name="IngestDocument" uriPattern="document" method="POST" />
        </Receiver>
        <Pipeline>
            <Exits>
                <Exit name="READY" state="SUCCESS" code="200" />
                <Exit name="ERROR" state="ERROR" code="400" />
            </Exits>
            <XmlValidatorPipe name="validate" schema="input.xsd" root="document">
                <Forward name="success" path="answerOk" />
                <Forward name="failure" path="answerError" />
            </XmlValidatorPipe>
        </Pipeline>
    </Adapter>
</Configuration>